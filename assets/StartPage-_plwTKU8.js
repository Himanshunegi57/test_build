import{r as o,u as x,$ as w,D as b,a as N,R as E,j as e,i as y,a0 as g,a1 as _,B as m,P as I,h as k,a2 as S,a3 as L,a4 as C,a5 as D,A as $,b as T,d as P,V as F,a6 as p,I as U,H as A,a7 as R}from"./index-cL-Drc9i.js";import{c as z,C as H}from"./CATLanguageDropdown-DspAJrYU.js";const q=()=>{const{examData:t}=x();return e.jsxs(e.Fragment,{children:[t.studentExamState.activeLang==="EN"&&e.jsx(H,{}),t.studentExamState.activeLang==="HI"&&e.jsx(e.Fragment,{children:t.test_second_language=="Indonesia"?e.jsx(U,{}):e.jsx(A,{})})]})},B=({})=>{const{examData:t}=x();return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex flex-col justify-between relative",children:e.jsx("div",{className:"h-[100%] w-full md:p-5 overflow-y-auto",children:e.jsx("div",{className:"prose",dangerouslySetInnerHTML:{__html:t.instructions.description}})})})})};function K(){const[t,r]=o.useState(1),{examData:a,dispatch:n}=x(),s=w(),[d,j]=o.useState(!0),v=async()=>{n({type:"start_exam",payload:Date.now()}),a.is_proctoring_allow&&R(),u({pathname:"/cat-exam/take",search:f.toString()})},[c,h]=o.useState(!1),u=b(),[f]=N();o.useEffect(()=>{var l;document.title=`${a.test_name}`,s.examData._id.$oid&&(n({type:"init",payload:{...s.examData,authUser:s.authUser}}),(l=s.examData)!=null&&l.start_date&&u({pathname:"/cat-exam/take",search:f.toString()}),j(!1))},[s]);const i=l=>{l.preventDefault()};return E.useEffect(()=>(document.addEventListener("copy",i),document.addEventListener("cut",i),document.addEventListener("paste",i),()=>{document.removeEventListener("copy",i),document.removeEventListener("cut",i),document.removeEventListener("paste",i)}),[]),e.jsxs("main",{className:"flex flex-1 flex-col   overflow-hidden min-h-screen w-full",children:[e.jsx("div",{className:"flex items-center bg-[#3b5998] text-center shadow z-10 justify-center px-2 py-2",children:e.jsx("div",{className:"flex items-center",children:e.jsx("h2",{className:"scroll-m-20 text-xs md:text-sm font-semibold tracking-tight first:mt-0 text-white",children:a.test_name})})}),e.jsxs("div",{className:"flex flex-row",children:[e.jsxs("div",{className:"flex flex-col relative md:w-4/5",children:[e.jsxs("div",{className:"flex flex-row justify-between p-2 bg-[#BCE8F5]",children:[e.jsx("h3",{className:"scroll-m-20 text-start text-md md:text-md font-bold tracking-tight pb-0 pt-0 text-[#676568]",children:a.studentExamState.activeLang=="EN"||a.test_second_language=="Indonesia"?"Instructions":"कृपया निम्नलिखित निर्देशों को ध्यान से पढ़ें"}),e.jsx("div",{className:"w-[150px]",children:e.jsx(z,{})})]}),e.jsxs(y,{className:g(" bg-white overflow-y-auto py-2 px-2 m-0 md:mx-2 font-serif text-sm",t==1?"h-[calc(80vh)] md:h-[calc(100vh-150px)]":"h-[calc(80vh)] md:h-[calc(100vh-230px)]"),children:[t==1?e.jsx(q,{}):"",t==2?e.jsx(B,{termsChecked:c,setTermsChecked:h}):""]}),t==2?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex pt-5 ps-10 border-t-2 space-x-2 md:gap-2",children:[e.jsx(_,{id:"terms",checked:c,onClick:()=>h(!c)}),e.jsxs("label",{htmlFor:"terms",className:"text-sm md:text-md ",children:[a.studentExamState.activeLang=="EN"?"I agree to the above terms and conditions for this examination.":"",a.studentExamState.activeLang=="HI"&&a.test_second_language!="Indonesia"?"मैंने पढ़ा है और निर्देश समझ लिया है। मेरे लिए आवंटित सभी कंप्यूटर हार्डवेयर उचित हालत में काम कर रहे हैं। मुझे लगता है मैं परीक्षा हॉल में मेरे साथ आदि मोबाइल फोन की तरह किसी भी निषिद्ध गैजेट / किसी भी निषिद्ध सामग्री नहीं ले जा रहा है कि इस बात से सहमत । मैं निर्देशों का पालन नहीं करने के मामले में , मुझे लगता है कि परीक्षा लेने से अयोग्य घोषित कर दिया जाएगा सहमत हैं।":"",a.studentExamState.activeLang=="HI"&&a.test_second_language=="Indonesia"?"Saya telah membaca dan memahami petunjuknya, dan saya siap untuk memulai ujian":""]})]})}):"",e.jsxs("div",{className:g("w-full overflow-hidden flex items-center justify-center gap-1 relative",{"border-t-2 pt-3 pb-3":t==1,"pt-6 pb-6":t==2}),children:[t==1?e.jsxs(m,{variant:"outline",onClick:()=>{r(2)},size:"lg",children:["Next ",e.jsx(I,{size:15,className:"ms-2"})]}):"",t==2?e.jsxs(e.Fragment,{children:[e.jsxs(m,{className:"absolute left-5",variant:"outline",onClick:()=>r(1),size:"lg",children:[e.jsx(k,{})," ",e.jsx("span",{className:"hidden md:block",children:"Previous"})]}),e.jsx(S,{children:e.jsxs(L,{children:[e.jsx(C,{asChild:!0,children:e.jsx(m,{className:"z-10 bg-blue-600 hover:bg-blue-800",variant:"default",size:"lg",disabled:!c,onClick:v,children:"Start Exam"})}),e.jsx(D,{children:e.jsx("p",{children:"Please accept terms and condition"})})]})})]}):""]})]}),e.jsx("div",{className:"hidden md:flex bg-white flex-col justify-start pt-10 border-l-2 border-gray-800 md:w-1/5",children:a.authUser&&e.jsxs("div",{className:"flex flex-col gap-2 justify-start h-[50px] items-center p-2 bg-white",children:[e.jsxs($,{className:"w-[100px] h-[100px]",children:[e.jsx(T,{src:a.authUser.profile_pic,className:"object-cover"}),e.jsx(P,{children:a.authUser.firstname[0]+a.authUser.lastname[0]})]}),e.jsx("p",{className:"font-medium text-md md:text-lg",children:`${a.authUser.firstname} ${a.authUser.lastname}`})]})})]}),e.jsx(F,{visible:d})]})}const M=async t=>{if(!t||t.length<=0)throw new Error("Invalid token");const r=p(t),n=await(await fetch(`${r.api_url}/generateTestTokenForStudentInternal/${r.test_id}?token=${t}`)).json();if(!n.status||!n.data||n.status===!1)throw new Error("Invalid token");return{...n.data,...r}},V=async(t,r)=>{if(!t||t.length<=0)throw new Error("Invalid token");const a=p(t),s=await(await fetch(`${a.api_url}/get-test-details/${a.package_id}/${a.test_series_id}/${a.test_id}/${a.is_preview?"preview":"undefined"}?webtesttoken=${r}`)).json();if(!s.data)throw new Error(s.msg);return s.data},O=async({params:t,request:r})=>{const n=new URL(r.url).searchParams.get("token"),s=await M(n),d=await V(n,s.webtesttoken);return{...t,authUser:s,examData:d}};export{K as StartPage,O as StartPageLoaderData,M as authenticateToken,V as getTestDetails};
